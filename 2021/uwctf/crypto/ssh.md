# crypto / ssh

> Points: 200

## Question

> Some say that an RSA private key is fully given by a triplet `(n, d, e)`. Well then, here's an RSA private key.
> Use it to SSH as root into chall.uwc.tf on port 2022.
> ```py
> n = 0x00a160badf8fd11566aa4890c9257daa62e7180a00c47294440bcad309c53dcf5584122dea365c01c4a6daeff4d10a5d98db84e27235f6a8b0a4750d2cf11817ba523b9451867cdedd92ef553a41b722794b50c978035fff41bdc7f0083280f897ee1901c9a0218da3b8088ba8f673d17fb2456d65170800d48626873b3d7a56e786c4aa55590f4d230b585629708005ffdc29c0279518466470fc21fbb576d6bbe4d60032598659bc168b5584df85b2fc8bbe11bb5f6f3448413a7a7af98f0fffa31201cbc1be338dcb9b47cc7214282df228d412b8dac2ec7bce0090931449e3cfa6f5881b4529472bd054bcf447f3f256ec78441e93573e7ca342e30644265d
> d = 0x2906a35b747f6e1664920024f2e008b20e18016b028632853e0e392a91b74dff6a8d0899336a9e9474ead1f80630c16cbbda038b8f867e8a31b5043d79a96b56d5d309b8d41ce8b7a1c4308197f54bd154415c86a32d03829e11b7470e37d57b226fbf1198210f962092239737d867d933e40c94978f544eb330164f0c290ef073e63b59bf2b3248d786522b6fda9d7dbf7929d5a5e09983f501fa22f942cf031dec1d0da71e3423e7f924570393858fcbee1e0da6bfbc068518b6877ae1fa3bdf01367aad07b1ef8dae84b46a7126dfd2b35efbba1b1d5cff53b3fa7ff7c5ca59b5a6bae49b864369d5ff4b0247621a4d8845a1b640f2c98c14b13006547f0d
> e = 0x10001
> ```

## Solution

We can construct RSA keys with PyCryptoDome:

```py
from Crypto.PublicKey import RSA
n = 0x00a160badf8fd11566aa4890c9257daa62e7180a00c47294440bcad309c53dcf5584122dea365c01c4a6daeff4d10a5d98db84e27235f6a8b0a4750d2cf11817ba523b9451867cdedd92ef553a41b722794b50c978035fff41bdc7f0083280f897ee1901c9a0218da3b8088ba8f673d17fb2456d65170800d48626873b3d7a56e786c4aa55590f4d230b585629708005ffdc29c0279518466470fc21fbb576d6bbe4d60032598659bc168b5584df85b2fc8bbe11bb5f6f3448413a7a7af98f0fffa31201cbc1be338dcb9b47cc7214282df228d412b8dac2ec7bce0090931449e3cfa6f5881b4529472bd054bcf447f3f256ec78441e93573e7ca342e30644265d
d = 0x2906a35b747f6e1664920024f2e008b20e18016b028632853e0e392a91b74dff6a8d0899336a9e9474ead1f80630c16cbbda038b8f867e8a31b5043d79a96b56d5d309b8d41ce8b7a1c4308197f54bd154415c86a32d03829e11b7470e37d57b226fbf1198210f962092239737d867d933e40c94978f544eb330164f0c290ef073e63b59bf2b3248d786522b6fda9d7dbf7929d5a5e09983f501fa22f942cf031dec1d0da71e3423e7f924570393858fcbee1e0da6bfbc068518b6877ae1fa3bdf01367aad07b1ef8dae84b46a7126dfd2b35efbba1b1d5cff53b3fa7ff7c5ca59b5a6bae49b864369d5ff4b0247621a4d8845a1b640f2c98c14b13006547f0d
key = RSA.construct((n, 0x10001, d))
with open('id_rsa', 'wb') as f:
    f.write(key.export_key())
```

Then, just use the newly generated key file:
```text
$ ssh root@chall.uwc.tf -p 2022
uwctf{pretty_tedious_huh_ec4b2625fcc5cf71}
5a6fc22bb21d:~#
```

### Flag

`uwctf{pretty_tedious_huh_ec4b2625fcc5cf71}`
